---
type: article
fc-calendar: Gregorian Calendar
fc-date: 
year: 2025
month: October
day: 02
creation date: 2025-10-02 15:39
modification date: Thursday 2nd October 2025 15:39:30
---

#dataScience  
## Article link:

related notes: 
- [[]]
_____
## Content

# **Introduction**

IoT-23 is a new dataset of network traffic from Internet of Things (IoT) devices. It has 20 malware captures executed in IoT devices, and 3 captures for benign IoT devices traffic. It was first published in January 2020, with captures ranging from 2018 to 2019. This IoT network traffic was captured in the Stratosphere Laboratory, AIC group, FEL, CTU University, Czech Republic. Its goal is to offer a large dataset of real and labeled IoT malware infections and IoT benign traffic for researchers to develop machine learning algorithms. This dataset and its research is funded by Avast Software, Prague. 

The IoT-23 dataset consists of twenty three captures (called _scenarios_) of different IoT network traffic. These scenarios are divided into twenty network captures (pcap files) from infected IoT devices (which will have the name of the malware sample executed on each scenario) and three network captures of real IoT devices network traffic (that have the name of the devices where the traffic was captured). On each malicious scenario we executed a specific malware sample in a Raspberry Pi, that used several protocols and performed different actions. Table 1 shows the characteristics of the IoT botnet scenarios and Table 2 shows the protocols that were found in each network traffic capture. The network traffic captured for the benign scenarios was obtained by capturing the network traffic of three different IoT devices: a Philips HUE smart LED lamp, an Amazon Echo home intelligent personal assistant and a Somfy smart doorlock. It is important to mention that these three IoT devices are real hardware and not simulated (see Images 1,2 and 3) . This allows us to capture and analyse real network behaviour. Both malicious and benign scenarios run in a controlled network environment with unrestrained internet connection like any other real IoT device. Table 3 shows the network data of the IoT benign scenarios and Table 4 shows the protocols found in each network capture.


The goal of this dataset is to make the two types of datasets available for the community: the first type contains malicious network traffic and the second one benign IoT traffic only. Both benign and malicious traffic flows have two new columns for network behaviour description labels. These labels are assigned following the next process:

- The original .pcap file is analysed manually. The suspicious flows are detected and labels are assigned in an analysis dashboard.
    
- The labels were assigned by using the rules defined in this spreadsheet [here](https://docs.google.com/spreadsheets/d/1HRqgKJp0XoSUIfW3rCQKoD_LnSCJ1k-k61PndJXWq_o/edit#gid=0), and our program [Flaber](https://github.com/stratosphereips/flaber). The labels were generated by an analyst.
    
- The Flaber python script reads the data of each flow in the conn.log file and compares this data with labeling rules. The script compares each flow with the rules and if the flow data fits the labeling criteria, the corresponding label is added.
    

> ## Notice that **the final labeled flows are in the files bro/conn.log.labeled for each capture.**

# **Summary of the datasets**

For each capture we provide a folder that contains the following files:

- **README.md**: this file has the capture and malware information such as the probable malware name, md5, sha1 and sha256 of the malware binary; the duration of the capture in seconds, the link to the VirusTotal malware file and some short description of the files inside the folder.
    
- **.pcap**: this the the original pcap file from the network traffic capture.
    
- **conn.log.labeled**: this is the Zeek conn.log file obtained by running the Zeek network analyser using the original pcap file. This conn.log.labeled file has the flows of the capture network connection as a normal Zeek conn.log file but it also has two new columns for the labels. Further in this document there is a list of the possible detailed labels with their description. 
    
- Other files generated that are explained in the further section **Individual details for IoT-23 captures**
    

## **IoT malicious flows dataset tables**

  
In this section we will show a summary from the twenty malicious scenarios. Table 1 shows the scenario number (ID), the name of the dataset, the duration in hours, the number of packets, the number of Zeek IDs flows in the conn.log file (obtained by running Zeek network analysis framework on the original pcap file), the size of the original pcap file and the possible name of the malware sample used to infect the device.  
Malware captures are executed for long periods of time. Due to the large size of the traffic generated by each infection, we rotate the pcaps files every 24 hours.  However, in some cases, the pcap file was growing too fast and we decided to stop the capture before the twenty-four hours were completed. For that reason, some of the captures differ in the amount of hours.

![](https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1579633409514-STQPQD3Q2SR76RQH1G0A/image-asset.png)

**Table 1: Summary of the Malicious IoT Scenarios**

To have some extra data regarding the network traffic generated by each infected device we used the application layer protocol prediction from Zeek to filter and summarize this information. In Table 2, this information is summarized, here, we included for each scenario, the name of the dataset, the amount of flows for the following protocols: HTTP, DNS, DHCP, Telnet, SSL and IRC. some protocols were not recognized by Zeek, there is a column where all this flows are quantified.

![](https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1579635449690-12KYOUEH050HMAU4SDCY/image-asset.png)

**Table 2: Breakdown of Application Layer Protocols as detected by Zeek on the Malicious Scenarios.**

  

## **IoT benign flows dataset tables**

In this section we show tables with the network information for the bening scenarios. These scenarios had been created by capturing network traffic data of not infected real IoT devices. The column with the malware name was changed to specify the device name.

The bening scenarios are obtained by capturing the network traffic of real IoT devices. It's important to see and understand how real IoT devices behave in the network when they are not infected. This will allow us to identify a change in the behavior when they are infected with malware or are under attack.

Table 3 shows the network data for each one of the bening scenarios, including information regarding the duration, number of packets, number of Zeek flows, pcap file and the name of the device. Table 4 shows the application layer detected protocols for each one of the bening scenarios.

![Screenshot 2021-05-08 at 17.17.58.png](https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1620490324777-7GBV1N5OW1N3DAX7F6IZ/Screenshot+2021-05-08+at+17.17.58.png)

**Table 3: Summary of the Benign scenarios.**

![Screenshot_20200121_174544.jpg](https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1579639657226-NVDX437OKF2D1XQ72404/Screenshot_20200121_174544.jpg)

**Table 4: Breakdown of Application Layer Protocols as detected by Zeek on the Benign Scenarios.**

# **Download the IoT-23 Dataset**

There are two options to download the IoT-23 dataset. The first option is the full download, that includes the original .pcap, README.md and conn.log.labeled files which are a part of a bigger group of files for each individual scenario which are listed in **Links to individual datasets in IoT-23**. The size for the full version is 20GB. The second option is to download  a light version that only contains the README.md and the conn.log file. The size for this version is 8.7GB. Both options are available to download in the following links:

**Full download link (20 GB):** [https://mcfp.felk.cvut.cz/publicDatasets/IoT-23-Dataset/iot_23_datasets_full.tar.gz](https://mcfp.felk.cvut.cz/publicDatasets/IoT-23-Dataset/iot_23_datasets_full.tar.gz)

**Small download link (8.7 GB):** [https://mcfp.felk.cvut.cz/publicDatasets/IoT-23-Dataset/iot_23_datasets_small.tar.gz](https://mcfp.felk.cvut.cz/publicDatasets/IoT-23-Dataset/iot_23_datasets_small.tar.gz)

Also each capture can be downloaded separately as described further in this document in the section.

# **Explanations of the labels**

To provide a more detailed information to network malware researchers and analysts, this dataset also contains labels to describe the relation between flows related to malicious or possible malicious activities. This labels were created in the Stratosphere laboratory considering the malware captures analysis. 

Here there is a brief explanation about the labels used for malicious flows detection based on the manual network analysis: 

**Attack:** this label indicates that there was some type of attack from the infected device to another host. Here we are labeling as attack to any flow that, by analysing its payload and behaviour, tries to take advantage of some vulnerable service. For example, a brute force to some telnet login, a command injection in the header of a GET request, etc.

**Benign:** this label indicates that no suspicious por malicious activities where found in the connections.

**C&C:** this label indicates that the infected device was connected to a CC server. This activity was detected in the analysis of the network malware capture because the connections to the suspicious server are periodic or our infected device is downloading some binaries from it or some IRC like or decoded orders are coming and going from it.

**DDoS:** this label indicates that a Distributed Denial of Service attack is being executed by the infected device. These traffic flows are detected as part of a DDoS ​​attack because of the amount of flows directed to the same IP address.

**FileDownload:** this label indicates that a file is being downloaded to our infected device. This is detected by filtering connections with response bytes more than 3KB or 5KB, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.

**HeartBeat:** this label indicates that packets sent on this connection are used to keep a track on the infected host by the C&C server. This was detected by filtering connections with response bytes lower than 1B and with periodic similar connections, normally this is combined with some known suspicious destination port or destination IP known to be a C&C server.

**Mirai:** this label indicates that the connections have characteristics of a Mirai botnet. This label is added when the flows has similar patterns as the most common known Mirai attacks. 

**Okiru:** this label indicates that the connections have characteristics of a Okiru botnet. This labeling decision was made with the same parameters as with Mirai but with the difference that this botnet family is less common.

**PartOfAHorizontalPortScan:** this label indicates that the connections are used to do a horizontal port scan to gather information to perform further attacks. To put these labels we rely on the pattern in which the connections shared the same port, a similar number of transmitted bytes and multiple different destination IPs.

**Torii:** this label indicates that the connections have characteristics of a Torii botnet. This labeling decision was made with the same parameters as with Mirai but with the difference that this botnet family is less common.

![Screenshot_20200121_175629.jpg](https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1579640258686-YCEOUK4AZ7EU43B1L4ON/Screenshot_20200121_175629.jpg)

**Table 5: label configuration file for CTU-IoT-Malware-Capture-33-1 capture.**

## **Distribution of labels in all IoT-23 datasets**

Once that all the labels are assigned, we can clearly see the most and least common labels in all 20 malware captures. The three most common malicious (not benign flows) labels are:  PartOfAHorizontalPortScan (213,852,924 flows), Okiru (47,381,241 flows) and  DDoS (19,538,713 flows). While the three least common malicious (not benign flows) labels are: C&C-Mirai (2 flows), PartOfAHorizontalPortScan-Attack (5 flows) and C&C-HeartBeat-FileDownload (11 flows). It's important to clarify that this table only shows the labels of the twenty malicious scenarios and it does not include the three benign scenarios, this decision is made because the benign scenarios will only increment the benign label total.

# **Individual details for IoT-23 captures**

In this section we show the label distribution for each scenario along with the links to its individual files. The files that can be found in each capture folder can be:

- **README.md**: this file has the capture and malware information.
    
- **README.html**: the html version of the README.md file.
    
- **.pcap**: this the the original pcap file from the network traffic capture.
    
- **.capinfos: a file generated with the capinfos tool that shows statistics of the .pcap file.**
    
- **.dnstop:  a file generated with the dnstop tool that displays various tables of DNS traffic on your network.**
    
- **.passivedns: a file with dns statistics of the .pcap file.**
    
- **.tcpdstat: a file generated with the tcpdstat tool with network statistics of the .pcap file.**
    
- **.weblogng: a file with web statistics of the .pcap file.**
    
- **miro_dashboard_analysis.jpg: a jpg image with the manual network analysis done in a Miro dashboard.**
    
- **conn.log.labeled**: this is the Zeek conn.log file obtained by running the Zeek network analyzer using the original pcap file.
    
- **A file with its name in md5**: this is the malware binary file.
    
- **bro folder: a folder with Zeek log files.**
    
    - **conn.log.labeled**: this is the Zeek conn.log file labeled.
        

In some cases we can find other files generated with different network analysis tools used to aid the manual network analysis.